{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, resolveComponent as _resolveComponent, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"comment-header\"\n};\nconst _hoisted_2 = {\n  class: \"username\"\n};\nconst _hoisted_3 = {\n  class: \"date\"\n};\nconst _hoisted_4 = {\n  class: \"comment-content\"\n};\nconst _hoisted_5 = {\n  class: \"comment-actions\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"reply-form\"\n};\nconst _hoisted_7 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_8 = {\n  class: \"reply-actions\"\n};\nconst _hoisted_9 = [\"disabled\"];\nconst _hoisted_10 = {\n  key: 1,\n  class: \"replies\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_CommentItem = _resolveComponent(\"CommentItem\", true);\n  return _openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"comment-item\", {\n      'reply': $props.isReply\n    }])\n  }, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"span\", _hoisted_2, _toDisplayString($props.comment.authorName), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_3, _toDisplayString($options.formatDate($props.comment.createdAt)), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_4, _toDisplayString($props.comment.content), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"button\", {\n    class: _normalizeClass([\"action-button like-button\", {\n      'liked': $props.comment.liked\n    }]),\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.handleLike && $options.handleLike(...args))\n  }, _toDisplayString($props.comment.liked ? '已讚' : '讚') + \" (\" + _toDisplayString($props.comment.likeCount) + \") \", 3 /* TEXT, CLASS */), _createElementVNode(\"button\", {\n    class: \"action-button reply-button\",\n    onClick: _cache[1] || (_cache[1] = $event => $data.showReplyForm = !$data.showReplyForm)\n  }, \" 回覆 \"), $options.isAuthor ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    class: \"action-button delete-button\",\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.confirmDelete && $options.confirmDelete(...args))\n  }, \" 刪除 \")) : _createCommentVNode(\"v-if\", true)]), _createCommentVNode(\" 回覆表單 \"), $data.showReplyForm ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.replyContent = $event),\n    placeholder: \"寫下你的回覆...\",\n    class: _normalizeClass({\n      'invalid': $data.replyError\n    })\n  }, null, 2 /* CLASS */), [[_vModelText, $data.replyContent]]), $data.replyError ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, _toDisplayString($data.replyError), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"button\", {\n    class: \"cancel-button\",\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.cancelReply && $options.cancelReply(...args))\n  }, \" 取消 \"), _createElementVNode(\"button\", {\n    class: \"submit-button\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.submitReply && $options.submitReply(...args)),\n    disabled: $data.isSubmitting\n  }, _toDisplayString($data.isSubmitting ? '提交中...' : '提交回覆'), 9 /* TEXT, PROPS */, _hoisted_9)])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 子回覆列表 \"), $props.comment.replies && $props.comment.replies.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.comment.replies, reply => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: reply.id,\n      class: \"reply-item\"\n    }, [_createVNode(_component_CommentItem, {\n      comment: reply,\n      currentUserId: $props.currentUserId,\n      isReply: true,\n      onAction: $options.handleAction\n    }, null, 8 /* PROPS */, [\"comment\", \"currentUserId\", \"onAction\"])]);\n  }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true)], 2 /* CLASS */);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_normalizeClass","$props","isReply","_createElementVNode","_hoisted_1","_hoisted_2","_toDisplayString","comment","authorName","_hoisted_3","$options","formatDate","createdAt","_hoisted_4","content","_hoisted_5","liked","onClick","_cache","args","handleLike","likeCount","$event","$data","showReplyForm","isAuthor","confirmDelete","_createCommentVNode","_hoisted_6","replyContent","placeholder","replyError","_hoisted_7","_hoisted_8","cancelReply","submitReply","disabled","isSubmitting","_hoisted_9","replies","length","_hoisted_10","_Fragment","_renderList","reply","id","_createVNode","_component_CommentItem","currentUserId","onAction","handleAction"],"sources":["/Users/lidiannan/Documents/GitHub/comment-system/frontend/src/components/Comment/CommentItem.vue"],"sourcesContent":["<template>\n    <div class=\"comment-item\" :class=\"{ 'reply': isReply }\">\n      <div class=\"comment-header\">\n        <span class=\"username\">{{ comment.authorName }}</span>\n        <span class=\"date\">{{ formatDate(comment.createdAt) }}</span>\n      </div>\n      \n      <div class=\"comment-content\">\n        {{ comment.content }}\n      </div>\n      \n      <div class=\"comment-actions\">\n        <button \n          class=\"action-button like-button\" \n          @click=\"handleLike\"\n          :class=\"{ 'liked': comment.liked }\"\n        >\n          {{ comment.liked ? '已讚' : '讚' }} ({{ comment.likeCount }})\n        </button>\n        \n        <button \n          class=\"action-button reply-button\" \n          @click=\"showReplyForm = !showReplyForm\"\n        >\n          回覆\n        </button>\n        \n        <button \n          v-if=\"isAuthor\" \n          class=\"action-button delete-button\" \n          @click=\"confirmDelete\"\n        >\n          刪除\n        </button>\n      </div>\n      \n      <!-- 回覆表單 -->\n      <div v-if=\"showReplyForm\" class=\"reply-form\">\n        <textarea \n          v-model=\"replyContent\" \n          placeholder=\"寫下你的回覆...\"\n          :class=\"{ 'invalid': replyError }\"\n        ></textarea>\n        <div v-if=\"replyError\" class=\"error-message\">{{ replyError }}</div>\n        <div class=\"reply-actions\">\n          <button \n            class=\"cancel-button\" \n            @click=\"cancelReply\"\n          >\n            取消\n          </button>\n          <button \n            class=\"submit-button\" \n            @click=\"submitReply\" \n            :disabled=\"isSubmitting\"\n          >\n            {{ isSubmitting ? '提交中...' : '提交回覆' }}\n          </button>\n        </div>\n      </div>\n      \n      <!-- 子回覆列表 -->\n      <div v-if=\"comment.replies && comment.replies.length > 0\" class=\"replies\">\n        <div \n          v-for=\"reply in comment.replies\" \n          :key=\"reply.id\" \n          class=\"reply-item\"\n        >\n          <CommentItem \n            :comment=\"reply\" \n            :currentUserId=\"currentUserId\" \n            :isReply=\"true\" \n            @action=\"handleAction\"\n          />\n        </div>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  export default {\n    name: 'CommentItem',\n    props: {\n      comment: {\n        type: Object,\n        required: true\n      },\n      currentUserId: {\n        type: Number,\n        required: true\n      },\n      isReply: {\n        type: Boolean,\n        default: false\n      }\n    },\n    data() {\n      return {\n        showReplyForm: false,\n        replyContent: '',\n        replyError: '',\n        isSubmitting: false\n      }\n    },\n    computed: {\n      isAuthor() {\n        return this.comment.authorId === this.currentUserId\n      }\n    },\n    methods: {\n      formatDate(dateString) {\n        const date = new Date(dateString)\n        return date.toLocaleString()\n      },\n      \n      handleLike() {\n        this.$emit('action', 'like', this.comment.id)\n      },\n      \n      validateReply() {\n        this.replyError = ''\n        \n        if (!this.replyContent.trim()) {\n          this.replyError = '回覆內容不能為空'\n          return false\n        }\n        \n        if (this.replyContent.length > 500) {\n          this.replyError = '回覆不能超過500字'\n          return false\n        }\n        \n        return true\n      },\n      \n      async submitReply() {\n        if (!this.validateReply()) {\n          return\n        }\n        \n        this.isSubmitting = true\n        \n        try {\n          await this.$emit('action', 'reply', this.comment.id, this.replyContent.trim())\n          this.replyContent = ''\n          this.showReplyForm = false\n        } catch (error) {\n          console.error('Failed to submit reply:', error)\n          this.replyError = error.message || '回覆失敗，請稍後再試'\n        } finally {\n          this.isSubmitting = false\n        }\n      },\n      \n      cancelReply() {\n        this.showReplyForm = false\n        this.replyContent = ''\n        this.replyError = ''\n      },\n      \n      confirmDelete() {\n        if (confirm('確定要刪除這則留言嗎？')) {\n          this.$emit('action', 'delete', this.comment.id)\n        }\n      },\n      \n      handleAction(action, commentId, content) {\n        // 將操作傳遞給父組件\n        this.$emit('action', action, commentId, content)\n      }\n    }\n  }\n  </script>\n  \n  <style scoped>\n  .comment-item {\n    border: 1px solid #eee;\n    border-radius: 8px;\n    padding: 15px;\n    margin-bottom: 15px;\n    background-color: #fff;\n  }\n  \n  .comment-item.reply {\n    border-left: 3px solid #4CAF50;\n    margin-left: 20px;\n    margin-top: 10px;\n  }\n  \n  .comment-header {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 10px;\n  }\n  \n  .username {\n    font-weight: bold;\n    color: #333;\n  }\n  \n  .date {\n    color: #777;\n    font-size: 14px;\n  }\n  \n  .comment-content {\n    margin-bottom: 15px;\n    line-height: 1.5;\n    word-break: break-word;\n  }\n  \n  .comment-actions {\n    display: flex;\n    gap: 10px;\n  }\n  \n  .action-button {\n    background: none;\n    border: none;\n    color: #666;\n    cursor: pointer;\n    font-size: 14px;\n    padding: 5px 10px;\n    border-radius: 4px;\n  }\n  \n  .action-button:hover {\n    background-color: #f0f0f0;\n  }\n  \n  .like-button.liked {\n    color: #4CAF50;\n    font-weight: bold;\n  }\n  \n  .delete-button {\n    color: #f44336;\n  }\n  \n  .reply-form {\n    margin-top: 15px;\n    padding-top: 15px;\n    border-top: 1px solid #eee;\n  }\n  \n  textarea {\n    width: 100%;\n    padding: 10px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    font-size: 14px;\n    resize: vertical;\n    margin-bottom: 10px;\n    font-family: inherit;\n  }\n  \n  textarea.invalid {\n    border-color: #ff6b6b;\n  }\n  \n  .error-message {\n    color: #ff6b6b;\n    font-size: 14px;\n    margin-bottom: 10px;\n  }\n  \n  .reply-actions {\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n  }\n  \n  .cancel-button {\n    background-color: #f1f1f1;\n    color: #333;\n    border: none;\n    padding: 8px 15px;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n  \n  .submit-button {\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    padding: 8px 15px;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n  \n  .submit-button:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n  }\n  \n  .replies {\n    margin-top: 15px;\n    padding-top: 10px;\n    border-top: 1px dashed #eee;\n  }\n  </style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}