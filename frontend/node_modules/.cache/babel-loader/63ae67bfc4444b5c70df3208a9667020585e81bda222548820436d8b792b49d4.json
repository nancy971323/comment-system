{"ast":null,"code":"export default {\n  name: 'CommentItem',\n  props: {\n    comment: {\n      type: Object,\n      required: true\n    },\n    currentUserId: {\n      type: Number,\n      required: true\n    },\n    isReply: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      showReplyForm: false,\n      replyContent: '',\n      replyError: '',\n      isSubmitting: false\n    };\n  },\n  computed: {\n    isAuthor() {\n      return this.comment.authorId === this.currentUserId;\n    }\n  },\n  methods: {\n    formatDate(dateString) {\n      const date = new Date(dateString);\n      return date.toLocaleString();\n    },\n    handleLike() {\n      this.$emit('action', 'like', this.comment.id);\n    },\n    validateReply() {\n      this.replyError = '';\n      if (!this.replyContent.trim()) {\n        this.replyError = '回覆內容不能為空';\n        return false;\n      }\n      if (this.replyContent.length > 500) {\n        this.replyError = '回覆不能超過500字';\n        return false;\n      }\n      return true;\n    },\n    async submitReply() {\n      if (!this.validateReply()) {\n        return;\n      }\n      this.isSubmitting = true;\n      try {\n        await this.$emit('action', 'reply', this.comment.id, this.replyContent.trim());\n        this.replyContent = '';\n        this.showReplyForm = false;\n      } catch (error) {\n        console.error('Failed to submit reply:', error);\n        this.replyError = error.message || '回覆失敗，請稍後再試';\n      } finally {\n        this.isSubmitting = false;\n      }\n    },\n    cancelReply() {\n      this.showReplyForm = false;\n      this.replyContent = '';\n      this.replyError = '';\n    },\n    confirmDelete() {\n      if (confirm('確定要刪除這則留言嗎？')) {\n        this.$emit('action', 'delete', this.comment.id);\n      }\n    },\n    handleAction(action, commentId, content) {\n      // 將操作傳遞給父組件\n      this.$emit('action', action, commentId, content);\n    }\n  }\n};","map":{"version":3,"names":["name","props","comment","type","Object","required","currentUserId","Number","isReply","Boolean","default","data","showReplyForm","replyContent","replyError","isSubmitting","computed","isAuthor","authorId","methods","formatDate","dateString","date","Date","toLocaleString","handleLike","$emit","id","validateReply","trim","length","submitReply","error","console","message","cancelReply","confirmDelete","confirm","handleAction","action","commentId","content"],"sources":["/Users/lidiannan/Documents/GitHub/comment-system/frontend/src/components/Comment/CommentItem.vue"],"sourcesContent":["<template>\n    <div class=\"comment-item\" :class=\"{ 'reply': isReply }\">\n      <div class=\"comment-header\">\n        <span class=\"username\">{{ comment.authorName }}</span>\n        <span class=\"date\">{{ formatDate(comment.createdAt) }}</span>\n      </div>\n      \n      <div class=\"comment-content\">\n        {{ comment.content }}\n      </div>\n      \n      <div class=\"comment-actions\">\n        <button \n          class=\"action-button like-button\" \n          @click=\"handleLike\"\n          :class=\"{ 'liked': comment.liked }\"\n        >\n          {{ comment.liked ? '已讚' : '讚' }} ({{ comment.likeCount }})\n        </button>\n        \n        <button \n          class=\"action-button reply-button\" \n          @click=\"showReplyForm = !showReplyForm\"\n        >\n          回覆\n        </button>\n        \n        <button \n          v-if=\"isAuthor\" \n          class=\"action-button delete-button\" \n          @click=\"confirmDelete\"\n        >\n          刪除\n        </button>\n      </div>\n      \n      <!-- 回覆表單 -->\n      <div v-if=\"showReplyForm\" class=\"reply-form\">\n        <textarea \n          v-model=\"replyContent\" \n          placeholder=\"寫下你的回覆...\"\n          :class=\"{ 'invalid': replyError }\"\n        ></textarea>\n        <div v-if=\"replyError\" class=\"error-message\">{{ replyError }}</div>\n        <div class=\"reply-actions\">\n          <button \n            class=\"cancel-button\" \n            @click=\"cancelReply\"\n          >\n            取消\n          </button>\n          <button \n            class=\"submit-button\" \n            @click=\"submitReply\" \n            :disabled=\"isSubmitting\"\n          >\n            {{ isSubmitting ? '提交中...' : '提交回覆' }}\n          </button>\n        </div>\n      </div>\n      \n      <!-- 子回覆列表 -->\n      <div v-if=\"comment.replies && comment.replies.length > 0\" class=\"replies\">\n        <div \n          v-for=\"reply in comment.replies\" \n          :key=\"reply.id\" \n          class=\"reply-item\"\n        >\n          <CommentItem \n            :comment=\"reply\" \n            :currentUserId=\"currentUserId\" \n            :isReply=\"true\" \n            @action=\"handleAction\"\n          />\n        </div>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  export default {\n    name: 'CommentItem',\n    props: {\n      comment: {\n        type: Object,\n        required: true\n      },\n      currentUserId: {\n        type: Number,\n        required: true\n      },\n      isReply: {\n        type: Boolean,\n        default: false\n      }\n    },\n    data() {\n      return {\n        showReplyForm: false,\n        replyContent: '',\n        replyError: '',\n        isSubmitting: false\n      }\n    },\n    computed: {\n      isAuthor() {\n        return this.comment.authorId === this.currentUserId\n      }\n    },\n    methods: {\n      formatDate(dateString) {\n        const date = new Date(dateString)\n        return date.toLocaleString()\n      },\n      \n      handleLike() {\n        this.$emit('action', 'like', this.comment.id)\n      },\n      \n      validateReply() {\n        this.replyError = ''\n        \n        if (!this.replyContent.trim()) {\n          this.replyError = '回覆內容不能為空'\n          return false\n        }\n        \n        if (this.replyContent.length > 500) {\n          this.replyError = '回覆不能超過500字'\n          return false\n        }\n        \n        return true\n      },\n      \n      async submitReply() {\n        if (!this.validateReply()) {\n          return\n        }\n        \n        this.isSubmitting = true\n        \n        try {\n          await this.$emit('action', 'reply', this.comment.id, this.replyContent.trim())\n          this.replyContent = ''\n          this.showReplyForm = false\n        } catch (error) {\n          console.error('Failed to submit reply:', error)\n          this.replyError = error.message || '回覆失敗，請稍後再試'\n        } finally {\n          this.isSubmitting = false\n        }\n      },\n      \n      cancelReply() {\n        this.showReplyForm = false\n        this.replyContent = ''\n        this.replyError = ''\n      },\n      \n      confirmDelete() {\n        if (confirm('確定要刪除這則留言嗎？')) {\n          this.$emit('action', 'delete', this.comment.id)\n        }\n      },\n      \n      handleAction(action, commentId, content) {\n        // 將操作傳遞給父組件\n        this.$emit('action', action, commentId, content)\n      }\n    }\n  }\n  </script>\n  \n  <style scoped>\n  .comment-item {\n    border: 1px solid #eee;\n    border-radius: 8px;\n    padding: 15px;\n    margin-bottom: 15px;\n    background-color: #fff;\n  }\n  \n  .comment-item.reply {\n    border-left: 3px solid #4CAF50;\n    margin-left: 20px;\n    margin-top: 10px;\n  }\n  \n  .comment-header {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 10px;\n  }\n  \n  .username {\n    font-weight: bold;\n    color: #333;\n  }\n  \n  .date {\n    color: #777;\n    font-size: 14px;\n  }\n  \n  .comment-content {\n    margin-bottom: 15px;\n    line-height: 1.5;\n    word-break: break-word;\n  }\n  \n  .comment-actions {\n    display: flex;\n    gap: 10px;\n  }\n  \n  .action-button {\n    background: none;\n    border: none;\n    color: #666;\n    cursor: pointer;\n    font-size: 14px;\n    padding: 5px 10px;\n    border-radius: 4px;\n  }\n  \n  .action-button:hover {\n    background-color: #f0f0f0;\n  }\n  \n  .like-button.liked {\n    color: #4CAF50;\n    font-weight: bold;\n  }\n  \n  .delete-button {\n    color: #f44336;\n  }\n  \n  .reply-form {\n    margin-top: 15px;\n    padding-top: 15px;\n    border-top: 1px solid #eee;\n  }\n  \n  textarea {\n    width: 100%;\n    padding: 10px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    font-size: 14px;\n    resize: vertical;\n    margin-bottom: 10px;\n    font-family: inherit;\n  }\n  \n  textarea.invalid {\n    border-color: #ff6b6b;\n  }\n  \n  .error-message {\n    color: #ff6b6b;\n    font-size: 14px;\n    margin-bottom: 10px;\n  }\n  \n  .reply-actions {\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n  }\n  \n  .cancel-button {\n    background-color: #f1f1f1;\n    color: #333;\n    border: none;\n    padding: 8px 15px;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n  \n  .submit-button {\n    background-color: #4CAF50;\n    color: white;\n    border: none;\n    padding: 8px 15px;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n  \n  .submit-button:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n  }\n  \n  .replies {\n    margin-top: 15px;\n    padding-top: 10px;\n    border-top: 1px dashed #eee;\n  }\n  </style>"],"mappings":"AAgFE,eAAe;EACbA,IAAI,EAAE,aAAa;EACnBC,KAAK,EAAE;IACLC,OAAO,EAAE;MACPC,IAAI,EAAEC,MAAM;MACZC,QAAQ,EAAE;IACZ,CAAC;IACDC,aAAa,EAAE;MACbH,IAAI,EAAEI,MAAM;MACZF,QAAQ,EAAE;IACZ,CAAC;IACDG,OAAO,EAAE;MACPL,IAAI,EAAEM,OAAO;MACbC,OAAO,EAAE;IACX;EACF,CAAC;EACDC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,aAAa,EAAE,KAAK;MACpBC,YAAY,EAAE,EAAE;MAChBC,UAAU,EAAE,EAAE;MACdC,YAAY,EAAE;IAChB;EACF,CAAC;EACDC,QAAQ,EAAE;IACRC,QAAQA,CAAA,EAAG;MACT,OAAO,IAAI,CAACf,OAAO,CAACgB,QAAO,KAAM,IAAI,CAACZ,aAAY;IACpD;EACF,CAAC;EACDa,OAAO,EAAE;IACPC,UAAUA,CAACC,UAAU,EAAE;MACrB,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,UAAU;MAChC,OAAOC,IAAI,CAACE,cAAc,CAAC;IAC7B,CAAC;IAEDC,UAAUA,CAAA,EAAG;MACX,IAAI,CAACC,KAAK,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,CAACxB,OAAO,CAACyB,EAAE;IAC9C,CAAC;IAEDC,aAAaA,CAAA,EAAG;MACd,IAAI,CAACd,UAAS,GAAI,EAAC;MAEnB,IAAI,CAAC,IAAI,CAACD,YAAY,CAACgB,IAAI,CAAC,CAAC,EAAE;QAC7B,IAAI,CAACf,UAAS,GAAI,UAAS;QAC3B,OAAO,KAAI;MACb;MAEA,IAAI,IAAI,CAACD,YAAY,CAACiB,MAAK,GAAI,GAAG,EAAE;QAClC,IAAI,CAAChB,UAAS,GAAI,YAAW;QAC7B,OAAO,KAAI;MACb;MAEA,OAAO,IAAG;IACZ,CAAC;IAED,MAAMiB,WAAWA,CAAA,EAAG;MAClB,IAAI,CAAC,IAAI,CAACH,aAAa,CAAC,CAAC,EAAE;QACzB;MACF;MAEA,IAAI,CAACb,YAAW,GAAI,IAAG;MAEvB,IAAI;QACF,MAAM,IAAI,CAACW,KAAK,CAAC,QAAQ,EAAE,OAAO,EAAE,IAAI,CAACxB,OAAO,CAACyB,EAAE,EAAE,IAAI,CAACd,YAAY,CAACgB,IAAI,CAAC,CAAC;QAC7E,IAAI,CAAChB,YAAW,GAAI,EAAC;QACrB,IAAI,CAACD,aAAY,GAAI,KAAI;MAC3B,EAAE,OAAOoB,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK;QAC9C,IAAI,CAAClB,UAAS,GAAIkB,KAAK,CAACE,OAAM,IAAK,YAAW;MAChD,UAAU;QACR,IAAI,CAACnB,YAAW,GAAI,KAAI;MAC1B;IACF,CAAC;IAEDoB,WAAWA,CAAA,EAAG;MACZ,IAAI,CAACvB,aAAY,GAAI,KAAI;MACzB,IAAI,CAACC,YAAW,GAAI,EAAC;MACrB,IAAI,CAACC,UAAS,GAAI,EAAC;IACrB,CAAC;IAEDsB,aAAaA,CAAA,EAAG;MACd,IAAIC,OAAO,CAAC,aAAa,CAAC,EAAE;QAC1B,IAAI,CAACX,KAAK,CAAC,QAAQ,EAAE,QAAQ,EAAE,IAAI,CAACxB,OAAO,CAACyB,EAAE;MAChD;IACF,CAAC;IAEDW,YAAYA,CAACC,MAAM,EAAEC,SAAS,EAAEC,OAAO,EAAE;MACvC;MACA,IAAI,CAACf,KAAK,CAAC,QAAQ,EAAEa,MAAM,EAAEC,SAAS,EAAEC,OAAO;IACjD;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}